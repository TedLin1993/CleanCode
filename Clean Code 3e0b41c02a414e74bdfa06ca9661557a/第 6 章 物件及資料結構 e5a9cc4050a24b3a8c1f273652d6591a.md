# ç¬¬ 6 ç«  ç‰©ä»¶åŠè³‡æ–™çµæ§‹

# **Getter-Setter and private variables**

ä½œè€…åœ¨æ›¸ä¸­æé†’æˆ‘å€‘é€™ä»¶äº‹ï¼Œæˆ‘å€‘ä½¿ç”¨ç§æœ‰ (private) è®Šæ•¸çš„ç†ç”±æ˜¯ã€Œ**ä¸å¸Œæœ›ä»»ä½•äººä¾è³´é€™äº›è®Šæ•¸**ã€ï¼Œä½†æ˜¯æœ‰è¨±å¤šå·¥ç¨‹å¸«æœƒè‡ªå‹•ç‚ºå®ƒå€‘åŠ ä¸Š getter èˆ‡ setterï¼Œè®“ç§æœ‰è®Šæ•¸å¦‚åŒå…¬ç”¨ (public) è®Šæ•¸ä¸€èˆ¬ã€‚

> å»¶ä¼¸é–±è®€ï¼šÂ ğŸ”— Why do we need private variables?
> 

# **è³‡æ–™çµæ§‹èˆ‡ç‰©ä»¶çš„å·®åˆ¥**

**è³‡æ–™çµæ§‹ (Data Structure) èˆ‡ç‰©ä»¶ (Object)** æ˜¯åå°ç¨±æ€§çš„å­˜åœ¨ï¼š

- **è³‡æ–™çµæ§‹**
    - å°‡è³‡æ–™ç›´æ¥æš´éœ²åœ¨å¤–ï¼Œå¯ä»¥ç›´æ¥å°è³‡æ–™è®€å–èˆ‡å¯«å…¥ã€‚ä¾‹å¦‚ï¼šlistã€dictã€set ç­‰ã€‚
    - çµæ§‹åŒ–(Procedural)çš„ç¨‹å¼ç¢¼(ä½¿ç”¨è³‡æ–™çµæ§‹çš„ç¨‹å¼ç¢¼)å®¹æ˜“æ·»åŠ æ–°çš„functionï¼Œè€Œä¸éœ€è¦è®Šå‹•å·²æœ‰çš„è³‡æ–™çµæ§‹
- **ç‰©ä»¶**
    - å°‡è³‡æ–™éš±è—èµ·ä¾†ï¼Œæä¾›å¯ä»¥æ“ä½œé€™äº›è³‡æ–™çš„å‡½å¼åœ¨å¤–é¢ã€‚ä¾‹å¦‚ï¼šÂ [ğŸ•¸ Crawler](https://github.com/scrapy/scrapy/blob/master/scrapy/crawler.py#L28)ã€[ğŸ•¸ CrawlerRunner](https://github.com/scrapy/scrapy/blob/master/scrapy/crawler.py#L119)ã€Â [ğŸ•¸ CrawlerProcess](https://github.com/scrapy/scrapy/blob/master/scrapy/crawler.py#L240)ã€‚
    - ç‰©ä»¶å°å‘çš„ç¨‹å¼ç¢¼å®¹æ˜“æ·»åŠ æ–°çš„classï¼Œè€Œä¸ç”¨è®Šå‹•å·²æœ‰çš„function
- çµæ§‹åŒ–çš„ç¨‹å¼ç¢¼é›£ä»¥æ·»åŠ æ–°çš„è³‡æ–™çµæ§‹ï¼Œå› ç‚ºå¿…é ˆæ”¹è®Šæ‰€æœ‰çš„functionã€‚è€Œç‰©ä»¶å°å‘çš„ç¨‹å¼ç¢¼é›£ä»¥æ·»åŠ æ–°çš„functionï¼Œå› ç‚ºå¿…é ˆæ”¹è®Šæ‰€æœ‰çš„class

å°‡è³‡æ–™å¯¦ç¾çš„éç¨‹éš±è—èµ·ä¾†ï¼Œå°±æ˜¯ä¸€ç¨®æŠ½è±¡åŒ–çš„éç¨‹ã€‚

ä¾‹å­: åœ–å‹

- Procedural:
    
    ```java
    public class Square {
    	 public Point topLeft;
    	 public double side;
    }
    public class Rectangle {
    	 public Point topLeft;
    	 public double height;
    	 public double width;
    }
    public class Circle {
    	 public Point center;
    	 public double radius;
    }
    public class Geometry {
    	 public final double PI = 3.141592653589793;
    	 public double area(Object shape) throws NoSuchShapeException
    	 {
    		 if (shape instanceof Square) {
    			 Square s = (Square)shape;
    			 return s.side * s.side;
    		 }
    		 else if (shape instanceof Rectangle) {
    			 Rectangle r = (Rectangle)shape;
    			 return r.height * r.width;
    		 }
    		 else if (shape instanceof Circle) {
    			 Circle c = (Circle)shape;
    			 return PI * c.radius * c.radius;
    		 }
    		 throw new NoSuchShapeException();
    	 }
    }
    ```
    
- OOP
    
    ```java
    public class Square implements Shape {
    	 private Point topLeft;
    	 private double side;
    	 public double area() {
    		 return side*side;
    	 }
    }
    public class Rectangle implements Shape {
    	 private Point topLeft;
    	 private double height;
    	 private double width;
    	 public double area() {
    		 return height * width;
    	 }
    }
    public class Circle implements Shape {
    	 private Point center;
    	 private double radius;
    	 public final double PI = 3.141592653589793;
    	 public double area() {
    		 return PI * radius * radius;
    	 }
    }
    ```
    

# **å¾·æ‘©ç‰¹çˆ¾æ³•å‰‡ (The Law of Demeter)**

- å¾·æ‘©ç‰¹çˆ¾æ³•å‰‡åˆå¯ä»¥ç¨±ä½œã€Œ**æœ€å°‘çŸ¥è­˜åŸå‰‡**ã€
- ç¬¦åˆ LoD çš„å‡½å¼è¦æ±‚åœ¨é¡åˆ¥C ä¸­çš„å‡½å¼ f åªèƒ½å‘¼å«ä»¥ä¸‹å¹¾ç¨®é¡å‹çš„å‡½å¼ï¼š
    1. C æœ¬èº«
    2. ä»»ä½•ç”±fæ‰€ç”¢ç”Ÿçš„ç‰©ä»¶
    3. ä»»ä½•ç•¶ä½œåƒæ•¸å‚³éçµ¦fçš„ç‰©ä»¶
    4. Cé¡åˆ¥è£¡å¯¦é«”è®Šæ•¸æ‰€æŒæœ‰çš„ç‰©ä»¶

LoD ç¯„ä¾‹ä½¿ç”¨ Pythonï¼š

```python
e = E()

class O:
    def __init__(self):
        self.a = A()

    def m(self, b):
        result = self.f()   # O æœ¬èº«çš„å‡½å¼
        b.execute()         # m çš„åƒæ•¸
        d = D()             # åœ¨ m ä¸­å»ºç«‹çš„ç‰©ä»¶
        d.join()
        self.a.run()        # å®£å‘Šåœ¨ O ä¸­çš„ç‰©ä»¶
        e.jump()            # è¢« O å­˜å–çš„å…¨åŸŸè®Šæ•¸ï¼Œä¸¦ä¸”åœ¨ m çš„ scope ä¸­

    def f(self):
        return 1+1
```

å¦‚æœä½ åœ¨ç¶²è·¯ä¸Šæœå°‹ï¼Œä¹Ÿè¨±æœƒçœ‹åˆ°æœ‰äººèªªï¼šã€ŒLoD ç¦æ­¢åœ¨ä¸€è¡Œç¨‹å¼ç¢¼ä¸­ä½¿ç”¨å¤šå€‹ dotã€ï¼Œé€™å¥è©±æ˜¯ä¸€åŠå°ä¸€åŠéŒ¯ï¼Œä½¿ç”¨å¤šå€‹ dot çš„å‰é¡Œæ˜¯ã€Œ**ä½ çŸ¥é“å®ƒå€‘æ˜¯è³‡æ–™çµæ§‹é‚„æ˜¯ç‰©ä»¶**ã€ã€‚

å¦‚æœæ˜¯ç‰©ä»¶ï¼Œå‰‡ç ´å£äº†ç‰©ä»¶å°è£ï¼›è€Œå¦‚æœæ˜¯è³‡æ–™çµæ§‹ï¼Œè³‡æ–™çµæ§‹æœ¬ä¾†å°±æš´éœ²äº†è³‡æ–™åœ¨å¤–é¢ï¼Œæ‰€ä»¥é€éå·¢ç‹€å­˜å–è³‡æ–™æ˜¯æ²’æœ‰å•é¡Œçš„ã€‚

```java
// ç ´å£å°è£ï¼Œé•å LoD
class A {
    fun(b) {
        b.getOption().getSelection()
    }
}

// å­˜å–è³‡æ–™çµæ§‹ï¼Œæ²’æœ‰é•å LoD 
data = {
    a: {
        b: 2
    }
}
console.log(data.a.b)
```

> ä½ ä¸æ‡‰è©²è®“ä¸€å€‹å‡½å¼çŸ¥é“å¤ªå¤šäº‹æƒ…ï¼Œå¦å‰‡æœƒç ´å£ç‰©ä»¶å°è£åŸæœ¬çš„æ„ç¾©ã€‚
> 

# è³‡æ–™å‚³è¼¸ç‰©ä»¶(Data Transfer Objects, DTO)

- åªæ˜¯ä¸€å€‹å¸¶æœ‰è³‡æ–™çš„ç‰©ä»¶ï¼Œæ²’æœ‰ä»»ä½•çš„æ“ä½œè¡Œç‚º
- å¸¸ç”¨æ–¼å’Œè³‡æ–™åº«æºé€š
- ä¾‹å­

```java
public class Address {
	 private String street;
	 private String streetExtra;
	 private String city;
	 private String state;
	 private String zip;

	 public Address(String street, String streetExtra, 
									String city, String state, String zip) {
		 this.street = street;
		 this.streetExtra = streetExtra;
		 this.city = city;
		 this.state = state;
		 this.zip = zip;
	 }

	 public String getStreet() {
		 return street;
	 }

	 public String getStreetExtra() {
		 return streetExtra;
	 }

	 public String getCity() {
		 return city;
	 }

	 public String getState() {
		 return state;
	 }

	 public String getZip() {
		 return zip;
	 }
}
```

# **å°çµ**

åœ¨ç‰©ä»¶èˆ‡è³‡æ–™çµæ§‹é€™å€‹ç« ç¯€ï¼Œæˆ‘å€‘é¦–å…ˆè«‡åˆ°ç‰©ä»¶çš„ç§æœ‰è®Šæ•¸ä¸æ‡‰è©²éš¨æ„å°‡å®ƒå€‘æš´éœ²åœ¨å¤–ï¼Œç‰©ä»¶å³æ˜¯è¦éš±è—å…¶å…§å®¹ï¼Œåªè®“å¤–éƒ¨çš„äººçœ‹è¦‹å®ƒå€‘æƒ³å…¬é–‹çš„è¡Œç‚ºï¼›å› æ­¤ï¼Œé–‹ç™¼æ™‚å¿…é ˆå°å¿ƒè¬¹æ…ç®¡ç†ç§æœ‰è®Šæ•¸ï¼Œå¦å‰‡ç§æœ‰è®Šæ•¸å°‡å¦‚åŒå…¬æœ‰è®Šæ•¸å½±éŸ¿æ•´å€‹ç³»çµ±ã€‚

æ­¤å¤–ï¼Œæˆ‘å€‘è«‡åˆ°è³‡æ–™çµæ§‹èˆ‡ç‰©ä»¶çš„ä¸åŒä¹‹è™•ï¼Œä½ ç¶“å¸¸æœƒåœ¨å¯«ç¨‹å¼æ™‚ç”¨åˆ°é€™å…©ç¨®æŠ€å·§ï¼Œä½†æ˜¯å®ƒå€‘çš„æ„ç¾©æ˜¯ä¸ä¸€æ¨£çš„ï¼Œç‚ºäº†æ–¹ä¾¿ç®¡ç†èˆ‡ç¶­è­·ï¼Œå¿…é ˆæ™‚æ™‚åˆ»åˆ»åœ¨æ„ç©¶ç«Ÿç¾åœ¨å¯«çš„æ˜¯è³‡æ–™çµæ§‹é‚„æ˜¯ç‰©ä»¶ã€‚

æœ€å¾Œï¼Œå¾·æ‘©ç‰¹çˆ¾æ³•å‰‡æ˜¯ä¸€ç¨®æ’°å¯«ç¨‹å¼çš„è¦ç¯„ï¼Œæˆ‘å€‘ä¸æ‡‰è©²çŸ¥é“å¤ªå¤šç‰©ä»¶å…§çš„äº‹æƒ…ï¼Œå¦å‰‡å°±æœƒç ´å£ç‰©ä»¶çš„å°è£ï¼Œè®“è¢«ä½¿ç”¨çš„ç‰©ä»¶é›£ä»¥è¢«ç¶­è­·ã€‚